<html>
<head>
    <script  defer src="resume_builder.js" type="text/javaScript"></script>

</head>
<body>
    
        Title<input id="data_input1" type="text"/>
        Name<input id="data_input2" type="text"/>
        <!-- <ul>
            skills:<input id="skills" type="text"/>

        </ul> -->
        <div id="skills">

        </div>
        <button onclick="add_newskills()">Add new skills</button>


        <div id="hobbies">

        </div>
        <button onclick="add_newhobbies()">Add new hobbies</button>
        <div id="languages">

        </div>
        <button onclick="add_newlanguage()">Add new language</button>


        <table border=1>
            <thead>
                <th>Course</th>
                <th>Inst_name</th>
                <th>percentage</th>
            </thead>
            <tbody id="tabledatas">
        
        
            </tbody>
        </table>
        

    <button type="button" onclick="edit()">Update</button>

</body>
<script>

    let params=new URLSearchParams(document.location.search);
    let index=params.get("index");

    let resume_data=localStorage.getItem("resumes");
    let resume_parsed=JSON.parse(resume_data);
    // console.log(resume_parsed[index])
    document.getElementById("data_input1").value=resume_parsed[index].title;
    document.getElementById("data_input2").value=resume_parsed[index].name;


   
    let skills_added=''    
   for (each of resume_parsed[index].skills){          

    skills_added=skills_added+`<input type="text" value=${each} class="added_skills"/>`  
            
   }
   
   
   
   document.getElementById("skills").innerHTML=skills_added


   let hobbies_added=''    
   for (each of resume_parsed[index].personal_details.hobbies){          
    hobbies_added=hobbies_added+`<input type="text" value="${each}" class="added_hobbies"/>`               
   }
   document.getElementById("hobbies").innerHTML=hobbies_added



   let languages_added=''    
   for (each of resume_parsed[index].personal_details.languages_known){          
    languages_added=languages_added+`<input type="text" value="${each}"" class="added_languages"/>`               
   }
   document.getElementById("languages").innerHTML=languages_added

   

   let no_of_education=''

for(let each in resume_parsed[index].education){

no_of_education=no_of_education+`<tr>
    <td><input type="text" value="${resume_parsed[index].education[each].course}" class="updated_education" onkeyup="edit(this,${each},'education','course')"/></td>
    <td><input type="text" value="${resume_parsed[index].education[each].inst}" class="updated_education" onkeyup="edit(this,${each},'education','inst')"/></td>
    <td><input type="text" value="${resume_parsed[index].education[each].percentage}" class="updated_education" onkeyup="edit(this,${each},'education','percentage')"/></td>
                               
    </tr>`
        }
        document.getElementById("tabledatas").innerHTML=no_of_education




   
   
// document.getElementById("education").innerHTML=education_qualification
// console.log(education_qualification);


function edit(ele,ed_index,key,c_key){
    let params=new URLSearchParams(document.location.search);
    let index=params.get("index");
   
    let new_array=[];
 
 for (let each in resume_parsed){
     if(index==each){           
        let updated_value1=document.getElementById("data_input1").value
        let updated_value2=document.getElementById("data_input2").value 
        resume_parsed[each].title=updated_value1;
        resume_parsed[each].name=updated_value2;         
 }
        new_array.push((resume_parsed)[each])


 }



    let updated_skills= document.getElementsByClassName("added_skills");
    // console.log(updated_skills);
    let skills_added=[]

    // console.log("updated_skills",updated_skills)
    for (let each of updated_skills){
        skills_added.push(each.value)
        // console.log(each);
    }
    
    console.log("skills_added",skills_added)
    resume_parsed[index].skills=skills_added;
    //localStorage.setItem("resumes",JSON.stringify(resume_parsed))



    
let updated_hobbies=document.getElementsByClassName("added_hobbies");
// console.log(updated_hobbies)
new_hobbies=[]
for(each of updated_hobbies){
    // console.log(each.value);
    new_hobbies.push(each.value);
}
resume_parsed[index].personal_details.hobbies=new_hobbies;
   


let updated_languages=document.getElementsByClassName("added_languages");
// console.log(updated_hobbies)
new_language=[]
for(each of updated_languages){
    // console.log(each.value);
    new_language.push(each.value);
}
resume_parsed[index].personal_details.languages_known=new_language;




    if(key=='education'){
 resume_parsed[index][key][ed_index][c_key]=ele.value;
    }
// console.log(element.value)
// window.location="edit.html"
    
localStorage.setItem("resumes",JSON.stringify(resume_parsed))

}


function add_newskills(){
    
    let resume_data=localStorage.getItem("resumes");
    let resume_parsed=JSON.parse(resume_data);
    let input=`<input type="text" class="added_skills"/>`
    // skills_added.push(input.value)

  document.getElementById("skills").innerHTML=skills_added+input;    
}

localStorage.setItem("resumes",JSON.stringify(resume_parsed))


function add_newhobbies(){
    
    let resume_data=localStorage.getItem("resumes");
    let resume_parsed=JSON.parse(resume_data);
    let input=`<input type="text" class="added_hobbies"/>`
    // skills_added.push(input.value)

  document.getElementById("hobbies").innerHTML=hobbies_added+input;

    
}

localStorage.setItem("resumes",JSON.stringify(resume_parsed))




function add_newlanguage(){
    
    let resume_data=localStorage.getItem("resumes");
    let resume_parsed=JSON.parse(resume_data);
    let input=`<input type="text" class="added_languages"/>`
    // skills_added.push(input.value)

  document.getElementById("languages").innerHTML=languages_added+input;

    
}

localStorage.setItem("resumes",JSON.stringify(resume_parsed))



// function education(element,ed_index,key){
//     let params=new URLSearchParams(document.location.search);
// let index=params.get("index");

//     let resume_data=localStorage.getItem("resumes");
//     let resume_parsed=JSON.parse(resume_data);
    
//     resume_parsed[index].education[ed_index][key]=element.value;

// // console.log(element.value)
// localStorage.setItem("resumes",JSON.stringify(resume_parsed))
// // window.location="edit.html"

// }
     



</script>
</html>